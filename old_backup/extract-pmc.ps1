#!/usr/bin/env pwsh
# PMC Base64 ZIP Extractor

Write-Host "Extracting PMC..." -ForegroundColor Green

$base64Data = "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"

$bytes = [System.Convert]::FromBase64String($base64Data)
[System.IO.File]::WriteAllBytes("pmc.zip", $bytes)

if (Get-Command Expand-Archive -ErrorAction SilentlyContinue) {
    Expand-Archive -Path "pmc.zip" -DestinationPath "." -Force
} else {
    # Fallback for older PowerShell
    Add-Type -AssemblyName System.IO.Compression.FileSystem
    [System.IO.Compression.ZipFile]::ExtractToDirectory("pmc.zip", ".")
}

Remove-Item "pmc.zip" -Force

Write-Host ""
Write-Host "âœ… PMC extraction complete!" -ForegroundColor Green
Write-Host ""
Write-Host "ðŸš€ To start PMC:" -ForegroundColor Cyan
Write-Host "   pwsh ./simple-pmc.ps1" -ForegroundColor White
Write-Host ""